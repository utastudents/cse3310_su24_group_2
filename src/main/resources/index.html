<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TURN OF DESTINY</title>
    <style>
        /* ... (keep existing styles) ... */
    </style>
</head>
<body>
    <div id="game-container">
        <h1>Turn of Destiny</h1>
        <div id="puzzle">Loading puzzle...</div>
        <div id="controls">
            <button onclick="sendUserAction('BUY_VOWEL', '')">Buy Vowel</button>
            <button onclick="selectConsonant()">Select Consonant</button>
            <button onclick="attemptSolve()">Solve Puzzle</button>
        </div>
        <div id="scoreboard">Scoreboard </div>
        <div id="current-player"></div>
    </div>

    <script>
        let socket = new WebSocket('ws://localhost:9180'); // Update if needed
        let playerId = null;

        socket.onopen = function() {
            console.log('WebSocket connection established');
        };

        socket.onmessage = function(event) {
            let data = JSON.parse(event.data);
            if (data.puzzle) {
                updateWordPuzzle(data.puzzle);
            }
            if (data.scores) {
                updateScoreboard(data.scores);
            }
            if (data.currentPlayer) {
                updateCurrentPlayer(data.currentPlayer);
            }
        };

        socket.onerror = function(error) {
            console.error('WebSocket error:', error);
        };

        socket.onclose = function() {
            console.log('WebSocket connection closed');
        };

        function updateWordPuzzle(puzzle) {
            document.getElementById('puzzle').textContent = puzzle;
        }

        function updateScoreboard(scores) {
            let scoreboard = document.getElementById('scoreboard');
            scoreboard.innerHTML = 'Scoreboard:<br>';
            scores.forEach(score => {
                let item = document.createElement('div');
                item.textContent = `${score.name}: ${score.score}`;
                scoreboard.appendChild(item);
            });
        }

        function updateCurrentPlayer(currentPlayerId) {
            let currentPlayerDiv = document.getElementById('current-player');
            if (currentPlayerId === playerId) {
                currentPlayerDiv.textContent = "It's your turn!";
                enableControls(true);
            } else {
                currentPlayerDiv.textContent = "Waiting for other player...";
                enableControls(false);
            }
        }

        function enableControls(enable) {
            let buttons = document.querySelectorAll('#controls button');
            buttons.forEach(button => {
                button.disabled = !enable;
            });
        }

        function sendUserAction(action, guess) {
            let userAction = {
                Action: action,
                Guess: guess,
                PlayerId: playerId
            };
            socket.send(JSON.stringify(userAction));
        }

        function selectConsonant() {
            let consonant = prompt("Enter a consonant:");
            if (consonant && consonant.length === 1 && consonant.match(/[bcdfghjklmnpqrstvwxyz]/i)) {
                sendUserAction('SELECT_CONSONANT', consonant.toUpperCase());
            } else {
                alert("Please enter a valid consonant.");
            }
        }

        function attemptSolve() {
            let guess = prompt("Enter your solution:");
            if (guess) {
                sendUserAction('SOLVE', guess.toUpperCase());
            }
        }
    </script>
</body>
</html>
